digraph Agents {
  label = "Network Agents"
  "User" [shape=box]

  subgraph cluster_agents {
    label = "Agents"
    "Inbound Query" [label="Inbound Query\n(Actor)"]
    "@fabric/core" [label="Fabric Agent"]
    "RAG" [label="RAG Agent"]
    "ALPHA" [label="ALPHA Agent (JS)"]
    "BETA" [label="BETA Agent (JS)"]
    "GAMMA" [label="GAMMA Agent (JS)"]
    "Augmentor"
    "Summarizer"
    "Extractor"
    "Validator"

    subgraph cluster_brain_members {
      label = "Network"
      "JEEVES"
      "ALPHA"
      "BETA"
      "GAMMA"
      "RAG"
    }
  }

  subgraph cluster_edge_nodes {
    "hub.fabric.pub"
    "alpha.jeeves.dev"
    "beta.jeeves.dev"
    "gamma.jeeves.dev"
    "gamma.trynovo.com"
  }

  subgraph cluster_services {
    "hub.fabric.pub"
    "alpha.jeeves.dev"
    "beta.jeeves.dev"
    "gamma.jeeves.dev"
    "gamma.trynovo.com"
  }

  # Pipeline
  "User" -> "Inbound Query" [label="CREATE_QUERY_REQUEST"]
  "Inbound Query" -> "@fabric/core" [label="CREATE_QUERY_ACTOR"]
  "@fabric/core" -> "Augmentor" [label="query"]
  "Augmentor" -> "RAG" [label="CREATE_QUERY_REQUEST"]

  "Fabric Agent" -> "RAG" [label="CREATE_QUERY_REQUEST"]
  {
    "beta.jeeves.dev"
  } -> "Fabric Agent" [label="NOTIFY_NEW_DOCUMENT"]

  "RAG" -> {
    "JEEVES"
    "ALPHA"
    "BETA"
    "GAMMA"
  } [label="STAGE_GATHER_RESPONSES"]

  {
    "ALPHA"
    "BETA"
    "GAMMA"
    "JEEVES"
  } -> "Summarizer" [label="STAGE_GATHER_RESPONSES"]

  "Summarizer" -> "Extractor" [label="STAGE_CARD_REQUEST"]
  "Extractor" -> "Validator" [label="STAGE_CARD_RESPONSE"]
  "Validator" -> "User" [label="STAGE_CARD_RESPONSE"]
}
