digraph Database {
  subgraph cluster_cloud {
    "Inbound Traffic" -> "http0" [label="HTTP"]
  }

  subgraph cluster_http {
    label="HTTP Server"
    "http0" [label="http0\nHTTP Server"]
  }

  subgraph cluster_database {
    label="Database"
    "sql0"
    "sql1"
    "sql2"
    "ndb0"
    "ndb1"
    "ndb2"

    subgraph cluster_ndb {
      label="NDB Cluster"
      "ndb0" [label="ndb0\nData Node"]
      "ndb1" [label="ndb1\nData Node"]
      "ndb2" [label="ndb2\nData Node"]
    }

    subgraph cluster_sql {
      label="SQL Nodes"
      "sql0" [label="sql0\nSQL Node"]
      "sql1" [label="sql1\nSQL Node"]
      "sql2" [label="sql2\nSQL Node"]
    }
  }

  subgraph cluster_agent {
    label="Agent"
    "agent0" [label="agent0\nAgent"]
    "summarizer" [label="summarizer\nSummarizer"]
    "mistral0" [label="mistral0\nMistral"]
    "mistral1" [label="mistral1\nMistral"]

    subgraph cluster_ai {
      label="AI"
      "ai0" [label="ai0\nAI"]
      "ai0" -> {
        "mistral0"
        "mistral1"
      } [label="Request"]

      {
        "mistral0"
        "mistral1"
      } -> {
        "summarizer"
      } [label="network response"]

      "validator" -> "ai0" [label="failure"]
    }
  }

  "ndb0" -> {"ndb1", "ndb2"} [label="NDB replication"]
  "ndb1" -> {"ndb2", "ndb0"} [label="NDB replication"]
  "ndb2" -> {"ndb0", "ndb1"} [label="NDB replication"]

  "sql0" -> "ndb0" [label="NDB API"]
  "sql1" -> "ndb1" [label="NDB API"]
  "sql2" -> "ndb2" [label="NDB API"]

  "http0" -> "sql0" [label="SQL"]
  "http0" -> "sql1" [label="SQL"]
  "http0" -> "sql2" [label="SQL"]

  "http0" -> "agent0" [label="Agent"]
  "agent0" -> "ai0" [label="AI"]

  # "agent0" -> "summarizer" [label="Summarizer"]

  {
    "mistral0"
    "mistral1"
  } [label="Request"]

  "summarizer" -> "validator" [label="success"]
  "validator" -> "http0" [label="success"]
}
